{"ast":null,"code":"var _jsxFileName = \"/Users/hahn/Desktop/React/info-retrieval-frontend/src/pages/query-page/query-page.component.jsx\";\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport { withRouter } from 'react-router-dom';\nimport DocSnapshot from '../../components/doc/doc-snapshot/doc-snapshot.component';\nimport PageNav from '../../components/page-nav/page-nav.component';\nimport AdvancedSearchBox from '../../components/search-box/advanced-search-box/advanced-search-box.component';\nimport { Container } from 'reactstrap';\nconst SEVER_URL = 'http://localhost:8090';\nconst QUERY_URL = 'query';\n\nclass QueryPage extends Component {\n  constructor(props) {\n    super(props);\n\n    this.localStore = () => {\n      localStorage.setItem('dateSince', this.state.dateSince);\n      localStorage.setItem('queryText', this.state.queryText);\n      localStorage.setItem('dateTo', this.state.dateTo);\n      localStorage.setItem('embedding', this.state.embedding);\n      localStorage.setItem('author', this.state.author);\n      console.log(localStorage.getItem('queryText'));\n    };\n\n    this.handleDateSinceChange = date => {\n      this.setState({\n        dateSince: date._d\n      }, () => {\n        console.log(this.state.dateSince);\n      });\n    };\n\n    this.handleDateToChange = date => {\n      this.setState({\n        dateTo: date._d\n      }, () => {\n        console.log(this.state.dateTo);\n      });\n    };\n\n    this.handleEmbeddingChange = event => {\n      this.setState({\n        embedding: !this.state.embedding\n      }, () => {\n        console.log(this.state.embedding);\n      });\n    };\n\n    this.handelTextChange = event => {\n      const {\n        value,\n        name\n      } = event.target;\n      this.setState({\n        [name]: value\n      }, () => {\n        console.log(name + ':' + value);\n      });\n    };\n\n    this.handleSubmit = event => {\n      event.preventDefault();\n      this.localStore();\n      axios.get(`${SEVER_URL}/${QUERY_URL}/text`, {\n        params: {\n          text: this.state.queryText,\n          author: this.state.author,\n          dateSince: this.state.dateSince,\n          dateTo: this.state.dateTo,\n          embedding: this.state.embedding,\n          page: this.state.curPage\n        }\n      }).then(response => response.data).then(response => this.setState({\n        content: response.content,\n        totalPage: response.totalPages,\n        queryText: localStorage.getItem('queryText'),\n        author: localStorage.getItem('author'),\n        dateSince: localStorage.getItem('dateSince'),\n        dateTo: localStorage.getItem('dateTo'),\n        curPage: 0,\n        embedding: localStorage.getItem('embedding')\n      }));\n    };\n\n    this.handleNav = (event, pagenum) => {\n      if (pagenum === -1) {\n        pagenum = this.state.curPage - 1;\n      } else if (pagenum === -2) {\n        pagenum = this.state.curPage + 1;\n      }\n\n      if (pagenum < 0 || pagenum > this.state.totalPage) return;\n      event.preventDefault();\n      console.log(pagenum);\n      this.localStore();\n      this.setState({\n        curPage: pagenum\n      }, () => axios.get(`${SEVER_URL}/${QUERY_URL}/text`, {\n        params: {\n          text: this.state.queryText,\n          author: this.state.author,\n          dateSince: this.state.dateSince,\n          dateTo: this.state.dateTo,\n          embedding: this.state.embedding,\n          page: this.state.curPage\n        }\n      }).then(response => response.data).then(response => this.setState({\n        content: response.content,\n        totalPage: response.totalPages,\n        queryText: localStorage.getItem('queryText'),\n        author: localStorage.getItem('author'),\n        dateSince: localStorage.getItem('dateSince'),\n        dateTo: localStorage.getItem('dateTo'),\n        curPage: pagenum,\n        embedding: localStorage.getItem('embedding')\n      })));\n    };\n\n    this.state = {\n      curPage: 0,\n      totalPage: -1,\n      queryText: '',\n      author: '',\n      dateSince: '',\n      dateTo: '',\n      embedding: false,\n      content: []\n    };\n  } // only called from the mainpage\n\n\n  componentDidMount() {\n    // the origin pass param from the 'location.search' field starts with '?', get\n    // rid of it\n    const text = this.props.location.search.substring(6);\n    axios.get(`${SEVER_URL}/${QUERY_URL}/text`, {\n      params: {\n        text: text,\n        page: this.state.curPage\n      }\n    }).then(response => response.data).then(response => {\n      this.setState({\n        queryText: text,\n        content: response.content,\n        totalPage: response.totalPages\n      });\n    });\n  }\n\n  handleRedirectDocInfo(docID) {\n    const curDocInfo = '';\n    this.state.content.map(docInfo => {\n      if (docInfo.id === docID) curDocInfo = docInfo;\n    });\n    localStorage.setItem('curDocInfo', curDocInfo);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        backgroundImage: \"url(\" + require(\"../../assets/img/covid19.jpg\") + \")\"\n      },\n      className: \"page-header page-header-xs\",\n      \"data-parallax\": true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"filter\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"motto text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 25\n      }\n    }, \"COVID-19 Advanced Search\"))), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(AdvancedSearchBox, {\n      handelTextChange: this.handelTextChange,\n      handlesubmit: this.handleSubmit,\n      handleDateSinceChange: this.handleDateSinceChange,\n      handleDateToChange: this.handleDateToChange,\n      handleEmbeddingChange: this.handleEmbeddingChange,\n      states: this.state,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(Container, {\n      style: {\n        marginTop: '-25px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 17\n      }\n    }, this.state.content.map(docinfo => /*#__PURE__*/React.createElement(DocSnapshot, {\n      key: docinfo.id,\n      info: docinfo,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 42\n      }\n    })), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 26\n      }\n    }), /*#__PURE__*/React.createElement(PageNav, {\n      totalPage: this.state.totalPage,\n      curPage: this.state.curPage,\n      handleNav: this.handleNav,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 21\n      }\n    })));\n  }\n\n}\n\nexport default withRouter(QueryPage);","map":{"version":3,"sources":["/Users/hahn/Desktop/React/info-retrieval-frontend/src/pages/query-page/query-page.component.jsx"],"names":["React","Component","axios","withRouter","DocSnapshot","PageNav","AdvancedSearchBox","Container","SEVER_URL","QUERY_URL","QueryPage","constructor","props","localStore","localStorage","setItem","state","dateSince","queryText","dateTo","embedding","author","console","log","getItem","handleDateSinceChange","date","setState","_d","handleDateToChange","handleEmbeddingChange","event","handelTextChange","value","name","target","handleSubmit","preventDefault","get","params","text","page","curPage","then","response","data","content","totalPage","totalPages","handleNav","pagenum","componentDidMount","location","search","substring","handleRedirectDocInfo","docID","curDocInfo","map","docInfo","id","render","backgroundImage","require","marginTop","docinfo"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport axios from 'axios';\nimport {withRouter} from 'react-router-dom';\nimport DocSnapshot from '../../components/doc/doc-snapshot/doc-snapshot.component';\nimport PageNav from '../../components/page-nav/page-nav.component';\nimport AdvancedSearchBox from '../../components/search-box/advanced-search-box/advanced-search-box.component';\nimport {Container} from 'reactstrap';\n\nconst SEVER_URL = 'http://localhost:8090';\nconst QUERY_URL = 'query'\n\nclass QueryPage extends Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            curPage: 0,\n            totalPage: -1,\n            queryText: '',\n            author: '',\n            dateSince: '',\n            dateTo: '',\n            embedding: false,\n            content: []\n        }\n    }\n\n    // only called from the mainpage\n    componentDidMount() {\n        // the origin pass param from the 'location.search' field starts with '?', get\n        // rid of it\n        const text = this\n            .props\n            .location\n            .search\n            .substring(6);\n\n        axios\n            .get(`${SEVER_URL}/${QUERY_URL}/text`, {\n            params: {\n                text: text,\n                page: this.state.curPage\n            }\n        })\n            .then(response => response.data)\n            .then(response => {\n                this.setState({queryText: text, content: response.content, totalPage: response.totalPages});\n            });\n    }\n\n    localStore = () => {\n        localStorage.setItem('dateSince', this.state.dateSince);\n        localStorage.setItem('queryText', this.state.queryText);\n        localStorage.setItem('dateTo', this.state.dateTo);\n        localStorage.setItem('embedding', this.state.embedding);\n        localStorage.setItem('author', this.state.author);\n        console.log(localStorage.getItem('queryText'));\n    }\n\n    handleDateSinceChange = (date) => {\n        this.setState({\n            dateSince: date._d\n        }, () => {\n            console.log(this.state.dateSince);\n        });\n\n    }\n    handleDateToChange = (date) => {\n        this.setState({\n            dateTo: date._d\n        }, () => {\n            console.log(this.state.dateTo);\n\n        });\n    }\n\n    handleEmbeddingChange = (event) => {\n\n        this.setState({\n            embedding: !this.state.embedding\n        }, () => {\n            console.log(this.state.embedding);\n\n        })\n    }\n\n    handelTextChange = (event) => {\n        const {value, name} = event.target;\n        this.setState({\n            [name]: value\n        }, () => {\n            console.log(name + ':' + value);\n\n        });\n    }\n\n    handleSubmit = (event) => {\n        event.preventDefault();\n        this.localStore();\n        axios\n            .get(`${SEVER_URL}/${QUERY_URL}/text`, {\n            params: {\n                text: this.state.queryText,\n                author: this.state.author,\n                dateSince: this.state.dateSince,\n                dateTo: this.state.dateTo,\n                embedding: this.state.embedding,\n                page: this.state.curPage\n            }\n        })\n            .then(response => response.data)\n            .then(response => this.setState({\n                content: response.content,\n                totalPage: response.totalPages,\n                queryText: localStorage.getItem('queryText'),\n                author: localStorage.getItem('author'),\n                dateSince: localStorage.getItem('dateSince'),\n                dateTo: localStorage.getItem('dateTo'),\n                curPage: 0,\n                embedding: localStorage.getItem('embedding')\n            }));\n    }\n\n    handleNav = (event, pagenum) => {\n        if (pagenum === -1) {\n            pagenum = this.state.curPage - 1;\n        } else if (pagenum === -2) {\n            pagenum = this.state.curPage + 1;\n        }\n        if(pagenum < 0 || pagenum > this.state.totalPage) return;\n        event.preventDefault();\n        console.log(pagenum);\n        this.localStore();\n        this.setState({\n            curPage: pagenum\n        }, () => axios.get(`${SEVER_URL}/${QUERY_URL}/text`, {\n            params: {\n                text: this.state.queryText,\n                author: this.state.author,\n                dateSince: this.state.dateSince,\n                dateTo: this.state.dateTo,\n                embedding: this.state.embedding,\n                page: this.state.curPage\n            }\n        }).then(response => response.data).then(response => this.setState({\n            content: response.content,\n            totalPage: response.totalPages,\n            queryText: localStorage.getItem('queryText'),\n            author: localStorage.getItem('author'),\n            dateSince: localStorage.getItem('dateSince'),\n            dateTo: localStorage.getItem('dateTo'),\n            curPage: pagenum,\n            embedding: localStorage.getItem('embedding')\n        })));\n    }\n\n    handleRedirectDocInfo(docID) {\n        const curDocInfo = '';\n        this.state.content.map((docInfo => {if(docInfo.id === docID) curDocInfo = docInfo}));\n        localStorage.setItem('curDocInfo', curDocInfo);\n    }\n\n    render() {\n        return (\n            <div>\n                <div\n                    style={{\n                    backgroundImage: \"url(\" + require(\"../../assets/img/covid19.jpg\") + \")\"\n                }}\n                    className=\"page-header page-header-xs\"\n                    data-parallax={true}>\n                    <div className=\"filter\"/>\n                    <div className=\"motto text-center\">\n                        <h1 >\n                            COVID-19 Advanced Search\n                        </h1>\n                    </div>\n                </div>\n                <div>\n                    <AdvancedSearchBox\n                        handelTextChange={this.handelTextChange}\n                        handlesubmit={this.handleSubmit}\n                        handleDateSinceChange={this.handleDateSinceChange}\n                        handleDateToChange={this.handleDateToChange}\n                        handleEmbeddingChange={this.handleEmbeddingChange}\n                        states={this.state}/>\n                </div>\n                <Container style={{\n                    marginTop: '-25px'\n                }}>\n\n                    {this\n                        .state\n                        .content\n                        .map(docinfo => (<DocSnapshot key={docinfo.id} info={docinfo}/>))\n}\n                    <br/><br/>\n                    <PageNav\n                        totalPage={this.state.totalPage}\n                        curPage={this.state.curPage}\n                        handleNav={this.handleNav}/>\n                </Container>\n\n            </div>\n        );\n    }\n}\n\nexport default withRouter(QueryPage);"]},"metadata":{},"sourceType":"module"}